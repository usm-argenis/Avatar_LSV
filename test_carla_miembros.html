<!DOCTYPE html>
<html>
<head>
    <title>Test Carla - Miembros</title>
</head>
<body>
    <h1>Test de Carga: Carla - Miembros</h1>
    <div id="status">Cargando...</div>
    <div id="results"></div>
    
    <script>
        const DICCIONARIO = {
            'miembro': { categoria: 'frase', archivo: 'miembros' },
            'miembros': { categoria: 'frase', archivo: 'miembros' },
            'traduccion': { categoria: 'frase', archivo: 'traduccion' }
        };
        
        const MAPEO_CATEGORIAS = {
            'frase': ['frase'],
            'general': ['horario', 'nuevo']
        };
        
        function obtenerCarpetas(categoria) {
            const carpetas = MAPEO_CATEGORIAS[categoria];
            if (carpetas) {
                return Array.isArray(carpetas) ?carpetas : [carpetas];
            }
            return [categoria];
        }
        
        async function testLoadGLB() {
            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');
            
            const testCases = [
                { palabra: 'miembros', avatar: 'Carla' },
                { palabra: 'traduccion', avatar: 'Carla' },
                { palabra: 'miembro', avatar: 'Carla' }
            ];
            
            for (const test of testCases) {
                const { palabra, avatar } = test;
                const info = DICCIONARIO[palabra];
                
                if (!info) {
                    resultsDiv.innerHTML += `<p>‚ùå ${palabra}: No est√° en diccionario</p>`;
                    continue;
                }
                
                const { categoria, archivo } = info;
                const carpetas = obtenerCarpetas(categoria);
                
                resultsDiv.innerHTML += `<p>üîç Probando: ${palabra} (${avatar})</p>`;
                resultsDiv.innerHTML += `<p style="margin-left:20px">‚îú‚îÄ Categor√≠a: ${categoria}</p>`;
                resultsDiv.innerHTML += `<p style="margin-left:20px">‚îú‚îÄ Archivo: ${archivo}</p>`;
                resultsDiv.innerHTML += `<p style="margin-left:20px">‚îú‚îÄ Carpetas posibles: ${carpetas.join(', ')}</p>`;
                
                let loaded = false;
                
                for (const carpeta of carpetas) {
                    const url = `http://10.171.95.217:8000/output/glb/${avatar}/${carpeta}/${avatar}_resultado_${archivo}.glb`;
                    
                    resultsDiv.innerHTML += `<p style="margin-left:20px">‚îú‚îÄ Intentando: ${url}</p>`;
                    
                    try {
                        const response = await fetch(url, { method: 'HEAD' });
                        
                        if (response.ok) {
                            resultsDiv.innerHTML += `<p style="margin-left:20px;color:green">‚îî‚îÄ ‚úÖ HTTP ${response.status} - ENCONTRADO</p>`;
                            loaded = true;
                            break;
                        } else {
                            resultsDiv.innerHTML += `<p style="margin-left:20px;color:orange">‚îú‚îÄ ‚ö†Ô∏è HTTP ${response.status}</p>`;
                        }
                    } catch (error) {
                        resultsDiv.innerHTML += `<p style="margin-left:20px;color:red">‚îú‚îÄ ‚ùå Error: ${error.message}</p>`;
                    }
                }
                
                if (!loaded) {
                    resultsDiv.innerHTML += `<p style="margin-left:20px;color:red">‚îî‚îÄ ‚ùå NO SE ENCONTR√ì en ninguna carpeta</p>`;
                }
                
                resultsDiv.innerHTML += `<hr>`;
            }
            
            statusDiv.textContent = '‚úÖ Pruebas completadas';
        }
        
        testLoadGLB();
    </script>
</body>
</html>
